CREATE TABLE ChucVu
(
	maCV CHAR(10),
	tenChucVu NVARCHAR2(30),
	PRIMARY KEY (maCV)
);

CREATE TABLE NhanVien
(
  maNV CHAR(10) NOT NULL,
  HoTenNV NVARCHAR2(50) NOT NULL,
  SdtNV VARCHAR(12) NOT NULL,
  DiaChiNV NVARCHAR2(50) NOT NULL,
  maCV CHAR(10) NOT NULL,
  PRIMARY KEY (maNV),
  FOREIGN KEY (maCV) REFERENCES ChucVu(maCV)
);

CREATE TABLE Luong
(
  maNV CHAR(10) NOT NULL,
  LuongCoBan INT NOT NULL,
  PhuCap INT,
  TongLuong AS (LuongCoBan + NVL(PhuCap, 0)),
  PRIMARY KEY (maNV),
  FOREIGN KEY (maNV) REFERENCES NHANVIEN(maNV)
);

CREATE TABLE ChamCong
(
  Id INT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) PRIMARY KEY,
  maNV CHAR(10) NOT NULL,
  GioVao DATE NOT NULL,
  GioRa DATE,
  FOREIGN KEY (maNV) REFERENCES NHANVIEN(maNV)
);

CREATE TABLE KhachHang
(
  maKH CHAR(10) NOT NULL,
  sdtKH VARCHAR(12) NOT NULL,
  HoTenKH NVARCHAR2(50) NOT NULL,
  EmailKH NVARCHAR2(50) NOT NULL,
  DiaChiKH NVARCHAR2(100) NOT NULL,
  CCCD INT NOT NULL,
  GioiTinh INT NOT NULL,
  PRIMARY KEY (maKH)
);

CREATE TABLE HoaDon
(
  maHD CHAR(10) NOT NULL,
  NgayLapHD DATE NOT NULL,
  TinhTrang NVARCHAR2(30) NOT NULL,
  TongHoaDon INT NOT NULL,
  maKH CHAR(10) NOT NULL,
  maNV CHAR(10) NOT NULL,
  PRIMARY KEY (maHD),
  FOREIGN KEY (maKH) REFERENCES KhachHang(maKH),
  FOREIGN KEY (maNV) REFERENCES NHANVIEN(maNV)
);

CREATE TABLE LoaiPhong
(
  maLoaiPH CHAR(10) NOT NULL,
  TenLoaiPH NVARCHAR2(50) NOT NULL,
  SoKhachToiDa INT NOT NULL,
  PRIMARY KEY (maLoaiPH)
);

CREATE TABLE TrangThaiPH 
(
  maTrangThaiPH INT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) PRIMARY KEY,
  trangThai NVARCHAR2(100)
);

CREATE TABLE Phong
(
  maPH CHAR(10) NOT NULL,
  TenPH NVARCHAR2(50) NOT NULL,
  GiaPH INT NOT NULL,
  TienNghiPH NVARCHAR2(100) NOT NULL,
  ThongTinPH NVARCHAR2(100) NOT NULL,
  maLoaiPH CHAR(10) NOT NULL,
  maTrangThai int,
  PRIMARY KEY (maPH),
  FOREIGN KEY (maLoaiPH) REFERENCES LoaiPhong(maLoaiPH),
  FOREIGN KEY (maTrangThai) REFERENCES TrangThaiPH(maTrangThaiPH)
);

CREATE TABLE TinhTrangDatPhong
(
  maTTDP INT GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) PRIMARY KEY,
  TinhTrang NVARCHAR2(100)
);

CREATE TABLE PhieuDatPhong
(
  maPDP CHAR(10) NOT NULL,
  NgayLapPDP DATE NOT NULL,
  NgayNhanPhong DATE NOT NULL,
  NgayTraPhong DATE NOT NULL,
  TongTien INT NOT NULL,
  maPH CHAR(10) NOT NULL,
  maTTDP INT NOT NULL,
  maKH CHAR(10) NOT NULL,
  PRIMARY KEY (maPDP),
  FOREIGN KEY (maPH) REFERENCES Phong(maPH),
  FOREIGN KEY (maTTDP) REFERENCES TinhTrangDatPhong(maTTDP),
  FOREIGN KEY (maKH) REFERENCES KhachHang(maKH)
);